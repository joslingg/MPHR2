{% extends 'health_records/base.html' %}
{% block title %}Import hồ sơ sức khoẻ{% endblock %}
{% block content %}

<div class="container mt-4">
  <h3 class="text-center mb-4">📥 Nhập hồ sơ sức khỏe từ Excel</h3>

  <div class="card shadow-sm p-4">
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <div class="mb-3">
        <label class="form-label fw-semibold">Chọn tệp Excel (.xls, .xlsx)</label>
        <input type="file" name="file" accept=".xls,.xlsx" class="form-control" required>
        <small class="text-muted">
          File phải có các cột: Mã nhân viên, Họ và tên, Năm sinh, Giới tính,
          Chức danh nghề nghiệp, Chức vụ, Khoa/Phòng, Đã tiêm vắc-xin, Tên vắc-xin,
          Ngày tiêm chủng, Năm khám, Ngày khám, Loại khám, Cơ sở khám, Chiều cao (cm),
          Cân nặng (kg), Huyết áp (mmHg), Phân loại sức khoẻ, Kết luận, Nhóm, Ghi chú, File PDF
        </small>
      </div>

      <div class="d-flex gap-3">
        <a href="{% url 'download_sample_healthrecord' %}" class="btn btn-info">📄 Tải file mẫu</a>
        <button type="submit" class="btn btn-success">📤 Import</button>
        <a href="{% url 'healthrecord_list' %}" class="btn btn-secondary">⬅ Quay lại</a>
      </div>
    </form>
  </div>

  {% if messages %}
    <div class="mt-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
</div>

{% endblock %}
